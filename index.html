<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalori & Makro Takip</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <h1>üçΩÔ∏è Kalori & Makro Takip</h1>
            <div class="date-display" id="dateDisplay"></div>
        </div>
        <div class="header-actions">
            <button class="icon-btn" id="settingsBtn" title="Ayarlar">‚öôÔ∏è</button>
            <button class="icon-btn" id="darkModeBtn" title="A√ßƒ±k Mod">‚òÄÔ∏è</button>
        </div>
    </header>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Ayarlar</h2>
                <button class="modal-close" id="closeSettings">‚úï</button>
            </div>
            <div class="modal-body">
                <!-- Profil Bilgileri -->
                <div class="settings-section-title">Profil Bilgileri</div>
                <div class="settings-row">
                    <div class="settings-group settings-half">
                        <label for="profileGender">Cinsiyet</label>
                        <select id="profileGender">
                            <option value="">Se√ßiniz</option>
                            <option value="male">Erkek</option>
                            <option value="female">Kadƒ±n</option>
                        </select>
                    </div>
                    <div class="settings-group settings-half">
                        <label for="profileAge">Ya≈ü</label>
                        <input type="number" id="profileAge" min="15" max="80" placeholder="25">
                    </div>
                </div>
                <div class="settings-row">
                    <div class="settings-group settings-half">
                        <label for="profileHeight">Boy (cm)</label>
                        <input type="number" id="profileHeight" min="120" max="220" placeholder="175">
                    </div>
                    <div class="settings-group settings-half">
                        <label for="profileWeight">Kilo (kg)</label>
                        <input type="number" id="profileWeight" min="40" max="200" step="0.1" placeholder="75">
                    </div>
                </div>
                <div class="settings-group">
                    <label for="profileActivity">Aktivite Seviyesi</label>
                    <select id="profileActivity">
                        <option value="1.2">Sedanter (masa ba≈üƒ±)</option>
                        <option value="1.375">Hafif aktif (haftada 1-3 g√ºn)</option>
                        <option value="1.55">Orta aktif (haftada 3-5 g√ºn)</option>
                        <option value="1.725">√áok aktif (haftada 6-7 g√ºn)</option>
                    </select>
                </div>
                <div class="settings-row">
                    <div class="settings-group settings-half">
                        <label for="profileTrainingDays">Haftalƒ±k Antrenman G√ºn√º</label>
                        <input type="number" id="profileTrainingDays" min="0" max="7" placeholder="0">
                    </div>
                    <div class="settings-group settings-half">
                        <label for="profileSteps">G√ºnl√ºk Adƒ±m (opsiyonel)</label>
                        <input type="number" id="profileSteps" min="0" max="50000" step="500" placeholder="8000">
                    </div>
                </div>
                <div class="settings-group">
                    <label for="profileGoalMode">Hedef Modu</label>
                    <select id="profileGoalMode">
                        <option value="cut_moderate">Yaƒü Yakƒ±m (S√ºrd√ºr√ºlebilir) - TDEE -%15</option>
                        <option value="cut_aggressive">Yaƒü Yakƒ±m (Agresif) - TDEE -%25</option>
                        <option value="maintain">Koruma - TDEE</option>
                        <option value="bulk">Kas Artƒ±≈üƒ± - TDEE +%10</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="calculateGoals" style="width:100%; margin-bottom: 12px;">Hedefleri Hesapla</button>

                <!-- √ñnerilen Hedefler Kutusu -->
                <div id="goalRecommendation" class="goal-recommendation" style="display:none;">
                    <div class="goal-rec-title">√ñnerilen Hedefler</div>
                    <div id="goalRecContent"></div>
                </div>

                <hr class="settings-divider">

                <!-- Hedef Deƒüerleri -->
                <div class="settings-section-title">Hedef Deƒüerleri</div>
                <div class="settings-group">
                    <label for="targetKcal">G√ºnl√ºk Kalori Hedefi</label>
                    <input type="number" id="targetKcal" min="1000" max="5000" step="100" value="2200">
                </div>
                <div class="settings-group">
                    <label for="targetProtein">Protein Hedefi (g)</label>
                    <input type="number" id="targetProtein" min="50" max="300" step="10" value="150">
                </div>
                <div class="settings-group">
                    <label for="targetCarb">Karbonhidrat Hedefi (g)</label>
                    <input type="number" id="targetCarb" min="50" max="500" step="10" value="250">
                </div>
                <div class="settings-group">
                    <label for="targetFat">Yaƒü Hedefi (g)</label>
                    <input type="number" id="targetFat" min="20" max="200" step="5" value="70">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelSettings">ƒ∞ptal</button>
                <button class="btn btn-primary" id="saveSettings">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Y√ºkleniyor...</p>
    </div>

    <div class="error-message" id="errorMessage" style="display: none;"></div>

    <!-- Main Content -->
    <div class="container">
        <div class="main-content">

            <!-- Left Column -->
            <div class="left-column">
                <!-- Calorie Summary Card -->
                <section class="summary-card">
                    <div class="calorie-display">
                        <div class="calorie-header">
                            <span class="calorie-label">G√ºnl√ºk Kalori</span>
                        </div>
                        <div class="calorie-values">
                            <span class="calorie-current" id="currentKcal">0</span>
                            <span class="calorie-target">/ <span id="targetKcalDisplay">2200</span></span>
                        </div>
                        <div class="calorie-bar-container">
                            <div class="calorie-bar" id="calorieBar" style="width: 0%"></div>
                        </div>
                        <div id="remainingKcal" class="calorie-remaining">Kalan: 2200 kcal</div>
                    </div>
                </section>

                <!-- Macro Bars Card -->
                <section class="stats-card">
                    <div class="stats-header">
                        <span class="stats-icon">üéØ</span>
                        <h2>G√ºnl√ºk Hedefler</h2>
                        <div class="goal-count" id="goalCount" style="display: none;">0 g√ºn üî•</div>
                    </div>

                    <div class="macro-list">
                        <div class="macro-item">
                            <div class="macro-header">
                                <span class="macro-label">Protein</span>
                                <span class="macro-value" id="proteinValue">0 / 150g</span>
                            </div>
                            <div class="macro-bar-container">
                                <div class="macro-bar protein-bar" id="proteinBar" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="macro-item">
                            <div class="macro-header">
                                <span class="macro-label">Karbonhidrat</span>
                                <span class="macro-value" id="carbValue">0 / 250g</span>
                            </div>
                            <div class="macro-bar-container">
                                <div class="macro-bar carb-bar" id="carbBar" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="macro-item">
                            <div class="macro-header">
                                <span class="macro-label">Yaƒü</span>
                                <span class="macro-value" id="fatValue">0 / 70g</span>
                            </div>
                            <div class="macro-bar-container">
                                <div class="macro-bar fat-bar" id="fatBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Kilo Takibi Card -->
                <section class="weight-card">
                    <div class="stats-header">
                        <span class="stats-icon">‚öñÔ∏è</span>
                        <h2>Kilo Takibi</h2>
                    </div>
                    <div class="weight-input-row">
                        <input type="number" id="weightInput" placeholder="Kilo (kg)" min="30" max="250" step="0.1">
                        <input type="date" id="weightDate">
                        <button class="btn btn-primary btn-sm" id="saveWeight">Kaydet</button>
                    </div>
                    <div id="weightStats" class="weight-stats" style="display:none;">
                        <div class="weight-stat-item">
                            <span class="weight-stat-label">7g Ortalama</span>
                            <span class="weight-stat-value" id="weightAvg7">-</span>
                        </div>
                        <div class="weight-stat-item">
                            <span class="weight-stat-label">Deƒüi≈üim</span>
                            <span class="weight-stat-value" id="weightChange">-</span>
                        </div>
                        <div class="weight-stat-item">
                            <span class="weight-stat-label">Adaptive TDEE</span>
                            <span class="weight-stat-value" id="adaptiveTdee">-</span>
                        </div>
                    </div>
                    <button class="btn btn-secondary btn-sm" id="updateGoalsAdaptive" style="display:none; width:100%; margin-top:8px;">Hedefleri Adaptive TDEE'ye G√∂re G√ºncelle</button>
                    <div class="weight-log-list" id="weightLogList"></div>
                </section>
            </div>

            <!-- Right Column -->
            <div class="right-column">
                <!-- Motivation Card -->
                <section class="motivation-card">
                    <div class="motivation-text" id="motivationText">
                        Y√ºkleniyor...
                    </div>
                </section>

                <!-- Chart Section -->
                <section class="chart-section">
                    <h2>üìä Son 7 G√ºn</h2>
                    <div class="chart-container" id="chartContainer">
                        <div class="chart-loading">Y√ºkleniyor...</div>
                    </div>
                </section>

                <!-- Tabs -->
                <div class="tabs-container">
                    <button class="tab-button active" onclick="switchTab('logs')">üìù Kayƒ±tlar</button>
                    <button class="tab-button" onclick="switchTab('add')">‚ûï Yeni Ekle</button>
                    <button class="tab-button" onclick="switchTab('catalog')">üìã T√ºm √úr√ºnler</button>
                    <button class="tab-button" onclick="switchTab('templates')">üì¶ ≈ûablonlar</button>
                </div>

                <!-- Logs Tab -->
                <div id="logs-tab" class="tab-content active">
                    <section class="logs-section">
                        <div class="logs-container" id="logsContainer">
                            <div class="logs-loading">Y√ºkleniyor...</div>
                        </div>
                    </section>
                </div>

                <!-- Add Tab -->
                <div id="add-tab" class="tab-content">
                    <section class="add-section">
                        <div class="add-form">
                            <div class="form-group">
                                <label>√úr√ºn Tipi</label>
                                <div class="radio-group radio-group-3">
                                    <label class="radio-label">
                                        <input type="radio" name="itemType" value="food" checked>
                                        <span>Yiyecek</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="itemType" value="drink">
                                        <span>ƒ∞√ßecek</span>
                                    </label>
                                    <label class="radio-label">
                                        <input type="radio" name="itemType" value="custom">
                                        <span>√ñzel</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Preset Section -->
                            <div id="preset-section">
                                <div class="form-group">
                                    <label for="searchInput">√úr√ºn Ara</label>
                                    <input type="text" id="searchInput" placeholder="√úr√ºn adƒ± yazƒ±n..." autocomplete="off">
                                    <div class="dropdown" id="dropdown"></div>
                                </div>
                            </div>

                            <!-- Custom Section -->
                            <div id="custom-section" style="display: none;">
                                <div class="form-group">
                                    <label for="customName">√úr√ºn Adƒ± ve Tipi</label>
                                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 12px;">
                                        <input type="text" id="customName" placeholder="√ñrn: Ev Yapƒ±mƒ± Yemek">
                                        <select id="customType" style="padding: 14px 16px; background: var(--bg-secondary); border: 2px solid var(--bg-card-hover); border-radius: var(--radius-md); color: var(--text-primary); font-size: 1rem; font-weight: 500; transition: all 0.2s ease;">
                                            <option value="food">Yiyecek</option>
                                            <option value="drink">ƒ∞√ßecek</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="custom-macros-grid">
                                    <div class="form-group">
                                        <label for="customKcal">Kalori</label>
                                        <input type="number" id="customKcal" placeholder="0" min="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="customProtein">Protein (g)</label>
                                        <input type="number" id="customProtein" placeholder="0" min="0" step="0.1">
                                    </div>
                                    <div class="form-group">
                                        <label for="customCarb">Karb (g)</label>
                                        <input type="number" id="customCarb" placeholder="0" min="0" step="0.1">
                                    </div>
                                    <div class="form-group">
                                        <label for="customFat">Yaƒü (g)</label>
                                        <input type="number" id="customFat" placeholder="0" min="0" step="0.1">
                                    </div>
                                </div>
                            </div>

                            <!-- Amount Input -->
                            <div class="form-group">
                                <label for="gramsInput" id="amountLabel">Miktar (gram)</label>
                                <input type="number" id="gramsInput" placeholder="100" min="1">
                            </div>

                            <!-- Preview -->
                            <div class="calculation-preview" id="calculationPreview" style="display: none;">
                                <div class="preview-grid">
                                    <div class="preview-item">
                                        <div class="preview-label">Kalori</div>
                                        <div class="preview-value" id="previewKcal">0</div>
                                    </div>
                                    <div class="preview-item">
                                        <div class="preview-label">Protein</div>
                                        <div class="preview-value" id="previewProtein">0g</div>
                                    </div>
                                    <div class="preview-item">
                                        <div class="preview-label">Karb</div>
                                        <div class="preview-value" id="previewCarb">0g</div>
                                    </div>
                                    <div class="preview-item">
                                        <div class="preview-label">Yaƒü</div>
                                        <div class="preview-value" id="previewFat">0g</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Add Button -->
                            <button class="btn-add" id="addButton">Ekle</button>
                        </div>
                    </section>
                </div>

                <!-- Catalog Tab -->
                <div id="catalog-tab" class="tab-content">
                    <section class="catalog-section">
                        <div class="catalog-controls">
                            <div class="catalog-filter-row">
                                <div class="catalog-category-btns">
                                    <button class="catalog-filter-btn active" data-category="all">T√ºm√º</button>
                                    <button class="catalog-filter-btn" data-category="food">üçó Yiyecek</button>
                                    <button class="catalog-filter-btn" data-category="drink">ü•§ ƒ∞√ßecek</button>
                                </div>
                            </div>
                            <input type="text" id="catalogSearch" placeholder="√úr√ºn ara..." class="catalog-search-input">
                        </div>
                        <div class="catalog-count" id="catalogCount">0 √ºr√ºn</div>
                        <div class="catalog-list" id="catalogList"></div>
                    </section>
                </div>

                <!-- Templates Tab -->
                <div id="templates-tab" class="tab-content">
                    <section class="templates-section">
                        <!-- Template List View -->
                        <div id="templateListView">
                            <div class="templates-header">
                                <h3>üì¶ Hazƒ±r ≈ûablonlar</h3>
                                <button class="btn btn-primary btn-sm" id="createTemplateBtn">+ Yeni ≈ûablon</button>
                            </div>
                            <div class="templates-list" id="templatesList"></div>
                        </div>

                        <!-- Template Create View -->
                        <div id="templateFormView" style="display: none;">
                            <div class="template-form-header">
                                <button class="btn btn-secondary btn-sm" id="backToTemplates">‚Üê Geri</button>
                                <h3>Yeni ≈ûablon</h3>
                            </div>
                            <div class="form-group">
                                <label for="templateName">≈ûablon Adƒ±</label>
                                <input type="text" id="templateName" placeholder="√ñrn: Sabah Kahvaltƒ±sƒ±">
                            </div>
                            <div class="template-items-list" id="templateItemsList"></div>
                            <div class="template-add-item">
                                <div class="form-group" style="margin-bottom: 8px;">
                                    <label>√úr√ºn Tipi</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="tplItemType" value="food" checked>
                                            <span>Yiyecek</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="tplItemType" value="drink">
                                            <span>ƒ∞√ßecek</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-bottom: 8px;">
                                    <label for="tplSearchInput">√úr√ºn Ara</label>
                                    <input type="text" id="tplSearchInput" placeholder="√úr√ºn adƒ± yazƒ±n..." autocomplete="off">
                                    <div class="dropdown" id="tplDropdown"></div>
                                </div>
                                <div class="form-group" style="margin-bottom: 8px;">
                                    <label for="tplGramsInput" id="tplAmountLabel">Miktar (gram)</label>
                                    <input type="number" id="tplGramsInput" placeholder="100" min="1">
                                </div>
                                <button class="btn btn-secondary" id="addItemToTemplate" style="width: 100%;">√úr√ºn Ekle</button>
                            </div>
                            <button class="btn btn-primary" id="saveTemplate" style="width: 100%; margin-top: 16px;">≈ûablonu Kaydet</button>
                        </div>
                    </section>
                </div>
            </div>

        </div>
    </div>

    <script type="module" src="app.js"></script>
    <script>
        // Tab switching functionality
        const tabLabels = {
            'logs': 'Kayƒ±tlar',
            'add': 'Yeni Ekle',
            'catalog': 'T√ºm √úr√ºnler',
            'templates': '≈ûablonlar'
        };

        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));

            const label = tabLabels[tabName];
            const clickedBtn = Array.from(document.querySelectorAll('.tab-button')).find(
                btn => btn.textContent.includes(label)
            );
            if (clickedBtn) clickedBtn.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');

            // Lazy render
            if (tabName === 'catalog' && typeof renderCatalog === 'function') renderCatalog();
            if (tabName === 'templates' && typeof renderTemplateList === 'function') renderTemplateList();
        }
    </script>
</body>
</html>
